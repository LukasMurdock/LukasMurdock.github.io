<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Making a book list</title>
  <meta name="description" content="Learning how to make a book list with Jekyll.">
  <link rel='canonical' href="http://localhost:4000/2019/10/19/making-a-book-list-copy/">
  <link rel="stylesheet" type="text/css" href="/css/main.css" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#f94643">
  <meta name="msapplication-TileColor" content="#b91d47">
  <meta name="theme-color" content="#ffffff">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="fPk8VHNqhVzOb2qHw5K0bg3w8WrInKiLQeqZBOteVFA" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155085538-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155085538-1');
</script> -->
<!-- Global site tag (gtag.js) - Google Analytics -->
  
    <style>
    .highlight .hll { background-color: #ffffcc }
.highlight .c { color: #608b4e } /* Comment */
.highlight .err { border: 1px solid #d16969 } /* Error */
.highlight .k { color: #c586c0 } /* Keyword */
.highlight .cm { color: #608b4e } /* Comment.Multiline */
.highlight .cp { color: #569cd6 } /* Comment.Preproc */
.highlight .c1 { color: #608b4e } /* Comment.Single */
.highlight .cs { color: #608b4e } /* Comment.Special */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gh { font-weight: bold } /* Generic.Heading */
.highlight .gp { font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { font-weight: bold } /* Generic.Subheading */
.highlight .kc { color: #569cd6 } /* Keyword.Constant */
.highlight .kd { color: #569cd6 } /* Keyword.Declaration */
.highlight .kn { color: #569cd6 } /* Keyword.Namespace */
.highlight .kp { color: #569cd6 } /* Keyword.Pseudo */
.highlight .kr { color: #569cd6 } /* Keyword.Reserved */
.highlight .kt { color: #007acc } /* Keyword.Type */
.highlight .s { color: #ce9178 } /* Literal.String */
.highlight .nc { color: #4ec9b0 } /* Name.Class */
.highlight .ow { color: #569cd6 } /* Operator.Word */
.highlight .sb { color: #ce9178 } /* Literal.String.Backtick */
.highlight .sc { color: #ce9178 } /* Literal.String.Char */
.highlight .sd { color: #ce9178 } /* Literal.String.Doc */
.highlight .s2 { color: #ce9178 } /* Literal.String.Double */
.highlight .se { color: #ce9178 } /* Literal.String.Escape */
.highlight .sh { color: #ce9178 } /* Literal.String.Heredoc */
.highlight .si { color: #ce9178 } /* Literal.String.Interpol */
.highlight .sx { color: #ce9178 } /* Literal.String.Other */
.highlight .sr { color: #ce9178 } /* Literal.String.Regex */
.highlight .s1 { color: #ce9178 } /* Literal.String.Single */
.highlight .ss { color: #ce9178 } /* Literal.String.Symbol */
.highlight .m { color: #4ec9b0 } /* Regular text */
.highlight .na { color: #569cd6 } /* YAML text */
.highlight .nn, .nv { color: #d4d4d4 } /* YAML Header */
.highlight .pi { color: #d4d4d4 } /* YAML Symbols */
.highlight .n { color: #9cdcfe } /* Javascript text */
.highlight .o { color: #d4d4d4 } /* Javascript Symbols */
.highlight .mi { color: #b5cea8 } /* Javascript Numbers */


.highlight {
    background-color: #1e1e1e;
    padding:0px 20px;
}

pre {
  white-space: pre;
  overflow: auto;
  font-size:13px;
  line-height: 1.3;
  padding: 20px 0px;
  }
    </style>
  
</head>

<body class="pagebody">

  <!-- <script data-goatcounter="https://lukasmurdock.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script> -->
    <div class="nav-menu" style="font-weight: bold;">Lukas Murdock</div>
  <ul class="nav-menu">
    <li><a href="/">About</a></li>
    <li><a href="/resources/">Resources</a></li>
    <li><a href="/writing/">Writing</a></li>
    <li> <a href="/contact/">Contact</a></li>
  </ul>

<div id="bottomnav" class="bottomnav">

  <div class="logo">
      <a href="/" aria-label="Home"><svg class="icon" width="42px" height="42px" viewBox="0 0 1000 1000" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M523.761,600.435l-0.031,49.829l0,0.003c0,26.496 -10.525,51.906 -29.261,70.641c-18.735,18.736 -44.145,29.261 -70.641,29.261l-0.196,0c-26.496,0 -51.906,-10.525 -70.641,-29.261c-18.736,-18.735 -29.261,-44.145 -29.261,-70.641l0,-0.003c0,-26.496 10.525,-51.906 29.261,-70.641c18.735,-18.736 44.145,-29.261 70.641,-29.261l0.196,0c1.673,0 50.952,0.126 50.952,0.126l0.063,-100.585l-1.291,0c0,0 0,0 0,0c-55.228,0 -100,-44.771 -100,-99.999l0,-0.001l50.001,0c0.096,27.632 22.524,50 50.177,50l1.144,0l0.032,-50.167l0,-0.003c0,-26.496 10.525,-51.906 29.26,-70.641c18.736,-18.736 44.146,-29.261 70.642,-29.261l0.196,0c26.496,0 51.906,10.525 70.641,29.261c18.735,18.735 29.261,44.145 29.261,70.641l0,0.003c0,26.496 -10.526,51.906 -29.261,70.641c-18.735,18.736 -44.145,29.261 -70.641,29.261l-0.196,0c-1.673,0 -50.952,-0.126 -50.952,-0.126l-0.063,100.621c24.513,0.128 60.8,0.302 76.586,0.302c27.653,0 50.081,-22.37 50.177,-50l50,0c0,0 0,0 0,0c0,55.228 -44.771,100 -100,100c0,0 0,0 0,0l-76.795,0Zm-100.031,99.782c13.262,0 25.979,-5.268 35.355,-14.644c9.377,-9.377 14.645,-22.095 14.645,-35.356l0,-49.903l-50.05,0c-13.247,0 -25.952,5.262 -35.32,14.63c-9.367,9.367 -14.63,22.072 -14.63,35.32c0,0.001 0,0.002 0,0.003c0,13.248 5.263,25.953 14.63,35.32c9.368,9.368 22.073,14.63 35.32,14.63l0.05,0Zm101.176,-350.434c0,-13.261 5.268,-25.979 14.645,-35.356c9.376,-9.377 22.094,-14.644 35.355,-14.644l0.05,0c13.247,0 25.952,5.262 35.32,14.63c9.367,9.367 14.63,22.072 14.63,35.32c0,0.001 0,0.002 0,0.003c0,13.248 -5.263,25.953 -14.63,35.32c-9.368,9.368 -22.073,14.63 -35.32,14.63l-50.05,0l0,-49.903Z"/></svg></a>
  </div>
  <div class="sandwich" onclick="menuOpen(this)">
      <div class="bottom-nav">
          <div class="topbar"></div>
          <div class="bottombar"></div>
      </div>
  </div>
  <div id="menu" class="menu">
      <a href="/resources/" class="bottomnav_link">Resources</a>
      <a href="/writing/" class="bottomnav_link">Writing</a>
      <a href="/" class="bottomnav_link">About</a>
      <a href="/contact/" class="bottomnav_link">Contact</a>
      
  </div>

</div>

<script>
  function menuOpen(x) {
    document.getElementById("bottomnav").classList.toggle('menu_open');
    x.classList.toggle("menu_cross");
  }
</script>








  <meta itemprop='og:image' content='http://localhost:4000/gbooksapi.jpg'>


<main>
  <div class="pagebody-content">
      <article itemscope itemtype='http://schema.org/BlogPosting'>
        
        
        <h1>Making a book list</h1>
        
        <p>Learning how to make a book list with Jekyll.</p>
        
        
        <div class="figure-container">
          <figure class="blog-figure image component image-big image-fullbleed body-copy-wide">
            <img class="picture-image"  alt='gbooksapi.jpg' src='/images/posts/gbooksapi.jpg'>
            <figcaption class="image-text">Google Developer APIs to the rescue.</figcaption>
          </figure>
        </div>
        

          <p><span style="color: rgba(51,51,51,.5);">The Problem: </span>finding all the information on books is annoying and time consuming.</p>

<p><span style="color: rgba(51,51,51,.5);">The Solution: </span>make technology do all the heavy lifting.</p>

<h3 id="some-things-we-need-to-get">Some things we need to get</h3>
<ul>
  <li>Title</li>
  <li>Author</li>
  <li>Book cover image</li>
</ul>

<h3 id="how-to-get-them">How to get them</h3>
<p>Now that we have some vague ideas of what we need to get, let’s explore <em>how we’re going to get them.</em></p>

<p>My first thought and the one I see implemented on other sites is <a href="https://www.goodreads.com">Goodreads</a>. Complete with <a href="https://www.goodreads.com/api">it’s own API</a> Goodreads is the choice for being in-sync. I’ve seen people implement progress updates, book reviews and ratings. But that’s all more than I’m looking to do with this. Also the Goodreads API is <em>very slow</em>.</p>

<p>Instead of fumbling around searching how to easily get an image for nearly any book cover like I did (cause hunting down an image for every update <em>seriously sucks</em>) I’ll lay out all the details here.</p>

<p>The solution: <a href="https://developers.google.com/books/docs/v1/using">Google Books API</a>.
<br /><span style="font-size: 12px;">Honestly I should’ve thought of that, thanks Google.</span></p>

<p>Google Books API is able to return the following information:</p>
<ul>
  <li>The kind of book</li>
  <li>Google Books link</li>
  <li>Title <span class="full-underline" style="font-size: 12px;">Yes!</span></li>
  <li>Subtitle</li>
  <li>Authors <span class="full-underline" style="font-size: 12px;">Yes!</span></li>
  <li>Publisher</li>
  <li>Published date</li>
  <li>Description</li>
  <li>Industry identifiers (ISBN, ASIN)</li>
  <li>Page count</li>
  <li>Print type</li>
  <li>Categories</li>
  <li>Average rating (from Google Books)</li>
  <li>Ratings count (from Google Books)</li>
  <li>Maturity rating</li>
  <li>Image thumbnails <span class="full-underline" style="font-size: 12px;">Yes!</span></li>
  <li>Text snippit
<br /><span style="font-size: 12px;">They’re really all yesses.</span></li>
</ul>

<h3 id="getting-the-information">Getting the information</h3>

<p>That all sounds cool but I’ve never dealt with an API before. What’s the least amount of information we can use to extract all the data from the API?</p>

<p>My thoughts: ISBN codes.</p>

<p>Jekyll supports <a href="https://jekyllrb.com/docs/datafiles/">YAML</a> for it’s <code class="highlighter-rouge">_data</code> directory and the structure is <a href="https://idratherbewriting.com/documentation-theme-jekyll/mydoc_yaml_tutorial">relatively simple</a>. To add a book the only thing I need to find is the ISBN code. Everything else auto populates from that.</p>

<p><code class="highlighter-rouge">booklist.yaml</code></p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="nn">---</span>
<span class="c1">#Book List</span>
<span class="na">books</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">isbn</span><span class="pi">:</span> <span class="m">9781250237231</span>
  <span class="pi">-</span> <span class="na">isbn</span><span class="pi">:</span> <span class="m">9780316478526</span>
  <span class="pi">-</span> <span class="na">isbn</span><span class="pi">:</span> <span class="s">9780525540830</span></code></pre></figure>

<p>Now we can pass this YAML formatted document as a JSON file and assign it to a variable on the <code class="highlighter-rouge">/booklist/</code> page.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Initializing variables for later</span>
<span class="kt">var</span> <span class="n">book_url</span><span class="o">;</span>
<span class="kt">var</span> <span class="n">imageLink</span><span class="o">;</span>
<span class="kt">var</span> <span class="n">isbnslist</span> <span class="o">=</span> <span class="o">[];</span>
<span class="kt">var</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>

<span class="o">{%</span> <span class="n">assign</span> <span class="n">isbncheck</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="na">data</span><span class="o">.</span><span class="na">booklist</span><span class="o">.</span><span class="na">books</span> <span class="o">|</span> <span class="n">jsonify</span> <span class="o">%}</span>

<span class="kt">var</span> <span class="n">isbns</span> <span class="o">=</span> <span class="o">{{</span> <span class="n">isbncheck</span> <span class="o">}}</span></code></pre></figure>

<p>I had to do a lot of looking to figure out how to optimize performance and query every book in a single request. I couldn’t find <a href="https://www.sitepoint.com/community/t/how-to-solve-google-books-api-403-restriction/286374/2">this solution</a> anywhere in the docs. Glad those errors are over with.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">for</span> <span class="o">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">isbns</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="o">{</span>
      <span class="n">isbnslist</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="nc">String</span><span class="o">(</span><span class="n">isbns</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">isbn</span><span class="o">));</span>
    <span class="o">}</span>

<span class="kd">const</span> <span class="n">url</span> <span class="o">=</span> <span class="n">isbnslist</span><span class="o">.</span><span class="na">reduce</span><span class="o">(</span>
  <span class="o">(</span><span class="n">res</span><span class="o">,</span> <span class="n">isbnslist</span><span class="o">,</span> <span class="n">index</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">res</span> <span class="o">+</span> <span class="o">(</span><span class="n">index</span> <span class="o">?</span> <span class="s">"+OR+"</span> <span class="o">:</span> <span class="s">""</span><span class="o">)</span> <span class="o">+</span> <span class="s">"isbn:"</span> <span class="o">+</span> <span class="n">isbnslist</span><span class="o">,</span>
  <span class="s">"https://www.googleapis.com/books/v1/volumes?q="</span>
<span class="o">)</span>

<span class="n">book_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s">"+&amp;fields=items(volumeInfo/description,volumeInfo/title,volumeInfo/authors,volumeInfo/imageLinks/thumbnail,volumeInfo/industryIdentifiers/identifier)+&amp;maxResults=40"</span></code></pre></figure>

<p>Just to show a little bit of what’s going on here without explaining it.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// ISBN list is now an array</span>
<span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">isbnslist</span><span class="o">)</span>
<span class="o">[</span>
  <span class="s">"9781250237231"</span><span class="o">,</span>
  <span class="s">"9780316478526"</span><span class="o">,</span>
  <span class="s">"9780525540830"</span>
<span class="o">]</span>

<span class="c1">// All books full data return</span>
<span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">url</span><span class="o">)</span>
<span class="s">"https://www.googleapis.com/books/v1/volumes
?q=isbn:9781250237231+OR+
isbn:9780316478526+OR+
isbn:9780525540830"</span>

<span class="c1">// Filter fields for only needed data</span>
<span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">book_url</span><span class="o">)</span>
<span class="s">"https://www.googleapis.com/books/v1/volumes
?q=isbn:9781250237231+OR+
isbn:9780316478526+OR+
isbn:9780525540830+
&amp;fields=items(
  volumeInfo/description,
  volumeInfo/title,
  volumeInfo/authors,
  volumeInfo/imageLinks/thumbnail,
  volumeInfo/industryIdentifiers/identifier
)
+&amp;maxResults=40"</span></code></pre></figure>

<p>Now that we have the URLs to the data, all we have to do fetch it and plug it where we want it.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">fetch</span><span class="o">(</span><span class="n">book_url</span><span class="o">)</span>
<span class="o">.</span><span class="na">then</span><span class="o">(</span><span class="n">res</span> <span class="o">=&gt;</span> <span class="n">res</span><span class="o">.</span><span class="na">json</span><span class="o">())</span>
<span class="o">.</span><span class="na">then</span><span class="o">((</span><span class="n">out</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>

  <span class="k">for</span> <span class="o">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
  <span class="n">document</span><span class="o">.</span><span class="na">getElementById</span><span class="o">(</span><span class="s">"grid-container"</span><span class="o">).</span><span class="na">innerHTML</span> <span class="o">+=</span> <span class="s">"&lt;div class="</span><span class="n">grid</span><span class="o">-</span><span class="n">item</span><span class="s">"&gt; &lt;a rel="</span><span class="n">nofollow</span><span class="s">" target="</span><span class="n">_blank</span><span class="s">" href="</span><span class="nl">https:</span><span class="c1">//www.google.com/search?q=" + out.items[i].volumeInfo.title.replace(/ /g, "+") + "+by+" + out.items[i].volumeInfo.authors[0].replace(/ /g, "+") + ""&gt; &lt;div&gt; &lt;img alt="" + out.items[i].volumeInfo.title + " book cover" src="" + out.items[i].volumeInfo.imageLinks.thumbnail.replace("&amp;edge=curl","") + ""&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt; &lt;h3&gt;&lt;a rel="nofollow" target="_blank" href="https://www.google.com/search?q=" + out.items[i].volumeInfo.title.replace(/ /g, "+") + "+by+" + out.items[i].volumeInfo.authors[0].replace(/ /g, "+") + ""&gt;" + out.items[i].volumeInfo.title + "&lt;/a&gt;&lt;/h3&gt; &lt;p class="item"&gt;by " + out.items[i].volumeInfo.authors[0] + "&lt;/p&gt; &lt;/div&gt; &lt;/div&gt;";</span>
<span class="o">}</span></code></pre></figure>

<p>That super long ‘<code class="highlighter-rouge">document.getElementByID</code>’ provides the entire HTML structure of the books selection. It loops for every book returned from the Google Books API (so it adds that HTML for every book). For a cheat sheet on what the variables link to:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/*
  Title: out.items[0].volumeInfo.title
  Author: out.items[0].volumeInfo.authors[0]
  Thumbnail: out.items[0].volumeInfo.imageLinks.thumbnail
  Description: out.items[0].volumeInfo.description
*/</span></code></pre></figure>

<p>To add some error handling in case the ISBN provided does not show up within the Google API I managed to throw an error to the console to determine which ISBN would need to be fixed.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java">  <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
  <span class="kt">var</span> <span class="n">loadedBooks</span> <span class="o">=</span> <span class="o">[]</span>
  <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nc">Object</span><span class="o">.</span><span class="na">keys</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">).</span><span class="na">length</span><span class="o">){</span>
    <span class="c1">//(Google API Supports ISBN_10, ISBN_13, ASIN...)</span>
    <span class="c1">// Find and save only ISBN 13 codes to loadedBooks array</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">volumeInfo</span><span class="o">.</span><span class="na">industryIdentifiers</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">identifier</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">){</span>
      <span class="n">loadedBooks</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">volumeInfo</span><span class="o">.</span><span class="na">industryIdentifiers</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">identifier</span><span class="o">)</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">loadedBooks</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">volumeInfo</span><span class="o">.</span><span class="na">industryIdentifiers</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">identifier</span><span class="o">)</span>
    <span class="o">}</span>
    <span class="n">i</span><span class="o">++;</span>
  <span class="o">}</span>

  <span class="nc">Array</span><span class="o">.</span><span class="na">prototype</span><span class="o">.</span><span class="na">diff</span> <span class="o">=</span> <span class="n">function</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">function</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span><span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">;}).</span><span class="na">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="o">){</span>
      <span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">function</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span><span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">;}))</span>
    <span class="o">}</span><span class="k">else</span><span class="o">{</span>
      <span class="k">return</span> <span class="s">"All books indexed"</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">};</span>

  <span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">isbnslist</span><span class="o">.</span><span class="na">diff</span><span class="o">(</span><span class="n">loadedBooks</span><span class="o">))</span>
<span class="o">})</span>
<span class="o">.</span><span class="na">catch</span><span class="o">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="o">{</span> <span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">({{</span> <span class="n">isbn</span><span class="o">.</span><span class="na">isbn</span> <span class="o">}});</span> <span class="k">throw</span> <span class="n">err</span> <span class="o">});</span></code></pre></figure>

<p>The <code class="highlighter-rouge">loadedBooks</code> array saves ISBNs that returned from the Google Books API. The <code class="highlighter-rouge">Array.prototype.diff</code> compares the <code class="highlighter-rouge">loadedBooks</code> against our <code class="highlighter-rouge">isbnslist</code> and logs any left out ISBNs to the console.</p>

<p><a href="/booklist/">View the book list</a></p>

<h3 id="full-code">Full code</h3>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Initializing variables for later</span>
<span class="kt">var</span> <span class="n">book_url</span><span class="o">;</span>
<span class="kt">var</span> <span class="n">imageLink</span><span class="o">;</span>
<span class="kt">var</span> <span class="n">isbnslist</span> <span class="o">=</span> <span class="o">[];</span>
<span class="kt">var</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>

<span class="o">{%</span> <span class="n">assign</span> <span class="n">isbncheck</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="na">data</span><span class="o">.</span><span class="na">booklist</span><span class="o">.</span><span class="na">books</span> <span class="o">|</span> <span class="n">jsonify</span> <span class="o">%}</span>

<span class="kt">var</span> <span class="n">isbns</span> <span class="o">=</span> <span class="o">{{</span> <span class="n">isbncheck</span> <span class="o">}}</span>

<span class="k">for</span> <span class="o">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">isbns</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="o">{</span>
      <span class="n">isbnslist</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="nc">String</span><span class="o">(</span><span class="n">isbns</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">isbn</span><span class="o">));</span>
    <span class="o">}</span>

<span class="kd">const</span> <span class="n">url</span> <span class="o">=</span> <span class="n">isbnslist</span><span class="o">.</span><span class="na">reduce</span><span class="o">(</span>
  <span class="o">(</span><span class="n">res</span><span class="o">,</span> <span class="n">isbnslist</span><span class="o">,</span> <span class="n">index</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="n">res</span> <span class="o">+</span> <span class="o">(</span><span class="n">index</span> <span class="o">?</span> <span class="s">"+OR+"</span> <span class="o">:</span> <span class="s">""</span><span class="o">)</span> <span class="o">+</span> <span class="s">"isbn:"</span> <span class="o">+</span> <span class="n">isbnslist</span><span class="o">,</span>
  <span class="s">"https://www.googleapis.com/books/v1/volumes?q="</span>
<span class="o">)</span>

<span class="n">book_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s">"+&amp;fields=items(volumeInfo/description,volumeInfo/title,volumeInfo/authors,volumeInfo/imageLinks/thumbnail,volumeInfo/industryIdentifiers/identifier)+&amp;maxResults=40"</span>

<span class="n">fetch</span><span class="o">(</span><span class="n">book_url</span><span class="o">)</span>
<span class="o">.</span><span class="na">then</span><span class="o">(</span><span class="n">res</span> <span class="o">=&gt;</span> <span class="n">res</span><span class="o">.</span><span class="na">json</span><span class="o">())</span>
<span class="o">.</span><span class="na">then</span><span class="o">((</span><span class="n">out</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>

  <span class="k">for</span> <span class="o">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
  <span class="n">document</span><span class="o">.</span><span class="na">getElementById</span><span class="o">(</span><span class="s">"grid-container"</span><span class="o">).</span><span class="na">innerHTML</span> <span class="o">+=</span> <span class="s">"&lt;div class="</span><span class="n">grid</span><span class="o">-</span><span class="n">item</span><span class="s">"&gt; &lt;a rel="</span><span class="n">nofollow</span><span class="s">" target="</span><span class="n">_blank</span><span class="s">" href="</span><span class="nl">https:</span><span class="c1">//www.google.com/search?q=" + out.items[i].volumeInfo.title.replace(/ /g, "+") + "+by+" + out.items[i].volumeInfo.authors[0].replace(/ /g, "+") + ""&gt; &lt;div&gt; &lt;img alt="" + out.items[i].volumeInfo.title + " book cover" src="" + out.items[i].volumeInfo.imageLinks.thumbnail.replace("&amp;edge=curl","") + ""&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt; &lt;h3&gt;&lt;a rel="nofollow" target="_blank" href="https://www.google.com/search?q=" + out.items[i].volumeInfo.title.replace(/ /g, "+") + "+by+" + out.items[i].volumeInfo.authors[0].replace(/ /g, "+") + ""&gt;" + out.items[i].volumeInfo.title + "&lt;/a&gt;&lt;/h3&gt; &lt;p class="item"&gt;by " + out.items[i].volumeInfo.authors[0] + "&lt;/p&gt; &lt;/div&gt; &lt;/div&gt;";</span>
<span class="o">}</span>

<span class="cm">/*
  Title: out.items[0].volumeInfo.title
  Author: out.items[0].volumeInfo.authors[0]
  Thumbnail: out.items[0].volumeInfo.imageLinks.thumbnail
  Description: out.items[0].volumeInfo.description
*/</span>

  <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
  <span class="kt">var</span> <span class="n">loadedBooks</span> <span class="o">=</span> <span class="o">[]</span>
  <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nc">Object</span><span class="o">.</span><span class="na">keys</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">).</span><span class="na">length</span><span class="o">){</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">volumeInfo</span><span class="o">.</span><span class="na">industryIdentifiers</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">identifier</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">){</span>
      <span class="n">loadedBooks</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">volumeInfo</span><span class="o">.</span><span class="na">industryIdentifiers</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">identifier</span><span class="o">)</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">loadedBooks</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">out</span><span class="o">.</span><span class="na">items</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">volumeInfo</span><span class="o">.</span><span class="na">industryIdentifiers</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">identifier</span><span class="o">)</span>
    <span class="o">}</span>
    <span class="n">i</span><span class="o">++;</span>
  <span class="o">}</span>

  <span class="nc">Array</span><span class="o">.</span><span class="na">prototype</span><span class="o">.</span><span class="na">diff</span> <span class="o">=</span> <span class="n">function</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">function</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span><span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">;}).</span><span class="na">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="o">){</span>
      <span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">function</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span><span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">;}))</span>
    <span class="o">}</span><span class="k">else</span><span class="o">{</span>
      <span class="k">return</span> <span class="s">"All books indexed"</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">};</span>

  <span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">isbnslist</span><span class="o">.</span><span class="na">diff</span><span class="o">(</span><span class="n">loadedBooks</span><span class="o">))</span>
<span class="o">})</span>
<span class="o">.</span><span class="na">catch</span><span class="o">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="o">{</span> <span class="n">console</span><span class="o">.</span><span class="na">log</span><span class="o">({{</span> <span class="n">isbn</span><span class="o">.</span><span class="na">isbn</span> <span class="o">}});</span> <span class="k">throw</span> <span class="n">err</span> <span class="o">});</span></code></pre></figure>

      </article>
  </div>
</main>
      

      <div style="display: grid; grid-template-columns: 50% 50%;" class="PageNavigation">
        
        <a style="color: #000; text-align: left; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" class="next more-btn" href="/2019/11/12/learning/">&laquo; Learning is like baking</a>
        
        
        <a style="color: #000; text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" class="prev more-btn" href="/2019/09/30/psychology-and-persuasion/">Psychology and Persuasion &raquo;</a>
        
      </div>

  <footer>
  <a
    href="https://instagram.com/lukasauras.rex"
    target="_blank"
    rel="noreferrer"
    aria-label="instagram account link"
  >
    <svg viewBox="0 0 24 24">
      <path
        fill="#0070c9"
        d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M17.25,5.5A1.25,1.25 0 0,1 18.5,6.75A1.25,1.25 0 0,1 17.25,8A1.25,1.25 0 0,1 16,6.75A1.25,1.25 0 0,1 17.25,5.5M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z"
      />
    </svg>
  </a>

  <a
    style="margin-left:20px;"
    href="https://www.twitter.com/Lukasauras_Rex"
    target="_blank"
    rel="noreferrer"
    aria-label="twitter account link"
  >
    <svg viewBox="0 0 24 24">
      <path
        fill="#0070c9"
        d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"
      />
    </svg>
  </a>

  <a
    style="margin-left:20px;"
    href="https://www.linkedin.com/in/lukas-murdock"
    target="_blank"
    rel="noreferrer"
    aria-label="twitter account link"
  >
    <svg viewBox="0 0 24 24">
      <path
        fill="#0070c9"
        d="M21,21H17V14.25C17,13.19 15.81,12.31 14.75,12.31C13.69,12.31 13,13.19 13,14.25V21H9V9H13V11C13.66,9.93 15.36,9.24 16.5,9.24C19,9.24 21,11.28 21,13.75V21M7,21H3V9H7V21M5,3A2,2 0 0,1 7,5A2,2 0 0,1 5,7A2,2 0 0,1 3,5A2,2 0 0,1 5,3Z"
      />
    </svg>
  </a>
  <a style="font-size: 17px; margin-left:20px;" href="/resources/"
    ><span>View resources</span></a>

<!-- Begin Mailchimp Signup Form -->

<style type="text/css">
  #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; border-radius: 12px; margin: 20px 0; max-width: 700px}
  #mc_embed_signup form {
    display: block;
    position: relative;
    text-align: left;
    padding: 20px;
}
#mc_embed_signup .mc-field-group {
    clear: left;
    position: relative;
    width: 96%;
    padding-bottom: 3%;
    min-height: 50px;
}
#mc_embed_signup .mc-field-group input {
    display: block;
    width: 100%;
    padding: 8px 0;
    text-indent: 10px;
    border-width: 1px;
    border-style: solid;
    border-radius: 4px;
    border-color: #aaa;
}
  #mc_embed_signup .mc-field-group label {display: block; margin-bottom: 3px; }
  #mc_embed_signup .button {
    clear: both;
    background-color: #0070c9;;
    border: 0 none;
    border-radius: 4px;
    transition: all 0.23s ease-in-out 0s;
    color: #FFFFFF;
    cursor: pointer;
    display: inline-block;
    font-size: 15px;
    font-weight: normal;
    height: 32px;
    line-height: 32px;
    margin: 0 5px 10px 0;
    padding: 0 22px;
    text-align: center;
    text-decoration: none;
    vertical-align: top;
    white-space: nowrap;
    width: auto;
}
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://lukasmurdock.us4.list-manage.com/subscribe/post?u=8bfa9df5f9bb1ec0748cc9c0f&amp;id=a375eb58a6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<h2 style="font-weight: bold; padding: 0; margin: 15px 0; font-size: 1.4em;">Subscribe <span style="font-weight: 400; font-size: .65em;">No spam, ever. Promise.</span></h2>
<div class="mc-field-group">
	<label for="mce-EMAIL">Where can I reach you?</label>
	<input type="email" placeholder="Email address" value="" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_8bfa9df5f9bb1ec0748cc9c0f_a375eb58a6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->



<!-- BEGIN TINYLETTER EMBED SIGNUP 
  <form
    style="margin: 20px 0; border-radius: 12px; background-color: #fff; padding:20px;text-align:left;"
    action="https://tinyletter.com/LukasMurdock"
    method="post"
    target="popupwindow"
    onsubmit="window.open('https://tinyletter.com/LukasMurdock', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true"
  >
    <p><label for="tlemail">Join my email list</label></p>
    <p>
      <input
        type="text"
        style="background-color: #f2f2f2; padding: 10px; width:87.6%; border-width: 2px; border-style: solid; border-radius: 4px; border-color: #0070c9;"
        name="email"
        id="tlemail"
        placeholder="Email"
      />
    </p>
    <input type="hidden" value="1" name="embed" /><input
      type="submit"
      value="Subscribe"
    />
    <p>
      <a href="https://tinyletter.com" target="_blank" rel="noopener"
        >powered by TinyLetter</a
      >
    </p>
  </form>
  -->

  <p>Copyright &copy; 2020 Lukas Murdock. All rights reserved.</p>

</footer>

</body>

</html>